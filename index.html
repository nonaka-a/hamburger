<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ゴールデン バーガー</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@800&family=Kiwi+Maru:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="fixed-container">
        <!-- 設定ボタン -->
        <button id="settings-icon">
            <svg viewBox="0 0 512 512" width="24" height="24">
                <path d="M487.4 315.7l-42.6-24.6c3.8-23.2 3.8-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-3.8 23.2-3.8 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z" fill="currentColor"/>
            </svg>
        </button>

        <div id="time-display-container">
            <div id="day-display">1日目</div>
            <div id="clock-display">10:00</div>
            <div id="rank-stars-container"></div>
        </div>

        <!-- ショップボタン -->
        <button id="shop-button">
            <img src="images/shop-icon.png" alt="ショップ">
        </button>

        <!-- コンテストボタン -->
        <button id="contest-button" style="display: none;">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" />
                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" />
                <path d="M4 22h16" />
                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22" />
                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22" />
                <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" />
            </svg>
        </button>

        <div id="settings-panel">
            <h3>設定</h3>
            <div class="settings-row">
                <span>ズーム:</span>
                <button id="zoom-out-button">－</button>
                <button id="zoom-in-button">＋</button>
            </div>
            <button id="fullscreen-button">全画面表示</button>
            <button id="sound-toggle-button" class="sound-on">音: オン</button>
            <button id="bgm-change-button" style="display:none;">BGM変更</button>
            <button id="reset-save-button" style="background-color: var(--main-orange); color: white; margin-top: 10px;">リセット</button>
            <button id="close-settings-button">とじる</button>
        </div>

        <div id="reset-confirm-modal" class="modal-overlay" style="z-index: 8000;">
            <div class="game-panel" style="width: 500px; text-align: center; border: 5px solid var(--main-red);">
                <h3 style="color: var(--main-red); font-size: 1.8em;">本当にリセットしますか？</h3>
                <p style="margin: 20px 0; font-size: 1.2em;">
                    これまでの記録がすべて消えます。<br>
                    この操作は取り消せません。
                </p>
                <div style="display: flex; justify-content: center; gap: 20px; margin-top: 20px;">
                    <button id="reset-yes-button" class="action-button-style" style="background-color: var(--main-red);">はい</button>
                    <button id="reset-no-button" class="action-button-style" style="background-color: var(--main-blue);">いいえ</button>
                </div>
            </div>
        </div>

        <!-- ショップ画面 -->
        <div id="shop-modal" class="modal-overlay">
            <div class="game-panel" id="shop-panel">
                <h2>ショップ</h2>
                <div id="shop-items-container"></div>
                <button id="close-shop-button">とじる</button>
            </div>
        </div>

        <!-- BGM選択モーダル -->
        <div id="bgm-select-modal" class="modal-overlay">
            <div class="game-panel" style="width: 400px; text-align: center;">
                <h3>音楽をえらんでね</h3>
                <div id="bgm-list" style="display:flex; flex-direction:column; gap:10px; margin:20px 0;">
                    <button class="bgm-option" data-index="0">たのしい曲</button>
                    <button class="bgm-option" data-index="1">ジャズな曲</button>
                    <button class="bgm-option" data-index="2">おしゃれな曲</button>
                    <button class="bgm-option" data-index="3">うんちの曲</button>
                    <button class="bgm-option" data-index="4">まほうの曲</button>
                </div>
                <button id="close-bgm-modal">とじる</button>
            </div>
        </div>

        <!-- コンテスト解放通知モーダル -->
        <div id="contest-unlock-modal" class="modal-overlay" style="z-index: 7500;">
            <div class="game-panel" style="width: 700px; text-align: center; border: 10px solid var(--main-orange); padding: 40px;">
                <h2 style="color: var(--main-yellow); font-size: 3em; margin: 0 0 20px; text-shadow: 3px 3px 0 var(--dark-brown);">祝！コンテスト解放！</h2>
                <img src="images/contest-icon-large.png" alt="コンテスト" style="width: 250px; height: auto; object-fit: contain; margin-bottom: 20px; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));">
                <p style="font-size: 1.8em; font-weight: 800; line-height: 1.4; color: var(--dark-brown); margin: 10px 0;">
                    トールバーガーコンテストへ<br>参加できるようになりました！
                </p>
                <p style="font-size: 1.3em; color: #555; margin-bottom: 30px;">
                    左上の <span style="display:inline-block; vertical-align:middle; background:white; border:2px solid var(--dark-brown); border-radius:50%; padding:2px;"><svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="var(--main-yellow)" stroke-width="3" style="vertical-align: middle;"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" /><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" /><path d="M4 22h16" /><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22" /><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22" /><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" /></svg></span> ボタンから参加してね！
                </p>
                <button id="contest-unlock-close-button" class="action-button-style" style="background-color: var(--main-green); font-size: 1.5em; padding: 15px 50px;">わかった！</button>
            </div>
        </div>

        <!-- ★新規追加: ハングリー×アングリー解放通知モーダル -->
        <div id="contest-hungry-unlock-modal" class="modal-overlay" style="z-index: 7500;">
            <div class="game-panel" style="width: 700px; text-align: center; border: 10px solid var(--main-red); padding: 40px; background-color: #fff0f0;">
                <h2 style="color: var(--main-red); font-size: 3em; margin: 0 0 20px; text-shadow: 3px 3px 0 var(--dark-brown);">新コンテスト解放！</h2>
                <img src="images/contest-hungry-icon.png" alt="ハングリーアングリー" style="width: 250px; height: auto; object-fit: contain; margin-bottom: 20px; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));">
                <p style="font-size: 1.8em; font-weight: 800; line-height: 1.4; color: var(--dark-brown); margin: 10px 0;">
                    「ハングリー×アングリー」<br>コンテストに参加できます！
                </p>
                <p style="font-size: 1.3em; color: #555; margin-bottom: 30px;">
                    コンテスト画面の <span style="display:inline-block; vertical-align:middle; background:var(--main-yellow); border:2px solid var(--dark-brown); border-radius:50%; padding:2px; font-weight:bold; width:30px; height:30px; line-height:24px;">▶</span> ボタンで切り替えてね！
                </p>
                <button id="contest-hungry-unlock-close-button" class="action-button-style" style="background-color: var(--main-green); font-size: 1.5em; padding: 15px 50px;">挑戦するぞ！</button>
            </div>
        </div>

        <!-- コンテストゲームモーダル -->
        <div id="contest-game-modal" class="modal-overlay" style="z-index: 2600;">
            <!-- スタート画面 (修正: 左右切り替えボタンを追加) -->
            <div id="contest-start-screen" class="game-panel" style="width: 600px; text-align: center; padding: 40px; position: relative;">
                <!-- 切り替えボタン -->
                <button id="contest-prev-button" class="contest-nav-button" style="left: 20px;">◀</button>
                <button id="contest-next-button" class="contest-nav-button" style="right: 20px;">▶</button>

                <!-- コンテスト情報コンテナ -->
                <div id="contest-info-container">
                    <img id="contest-info-image" src="images/contest-icon-large.png" alt="コンテスト" style="width: 480px; height: auto; margin-bottom: 10px;">
                    <h2 id="contest-info-title" style="color: var(--main-orange); font-size: 2.5em; margin: 10px 0;">トールバーガーコンテスト</h2>
                    <div id="contest-info-desc" style="font-size: 1.2em; line-height: 1.6; margin: 20px 0; background: #fff; padding: 20px; border-radius: 15px; border: 3px dashed var(--dark-brown);">
                        <p style="margin: 0 0 10px;">落ちてくる具材を<br><strong>下のバンズ</strong>でキャッチして<br>高く積み上げよう！</p>
                        <p style="margin: 0;">制限時間は20秒。<br>最後に<strong>上のバンズ</strong>を乗せて完成だ！</p>
                    </div>
                    <!-- ロック表示用 -->
                    <div id="contest-lock-message" style="display: none; color: var(--main-red); font-weight: bold; font-size: 1.5em; margin-bottom: 10px;">
                        ランク4で解放！
                    </div>
                </div>

                <div style="display: flex; justify-content: center; gap: 20px; margin-top: 20px;">
                    <button id="contest-start-button" class="action-button-style" style="background-color: var(--main-red); font-size: 1.5em; padding: 15px 40px;">挑戦する</button>
                    <button id="contest-close-button" class="action-button-style" style="background-color: var(--main-blue); font-size: 1.5em; padding: 15px 40px;">やめる</button>
                </div>
            </div>

            <!-- ゲーム画面 (トールバーガー) -->
            <div id="contest-play-screen" class="game-panel" style="display: none; padding: 10px; width: 1200px; height: 680px; position: relative;">
                <div style="position: absolute; top: 30px; left: 30px; font-size: 2em; font-weight: bold; color: white; text-shadow: 2px 2px 0 #000; z-index: 10;">
                    残り時間: <span id="contest-timer">20</span>
                </div>
                <div style="position: absolute; top: 30px; right: 30px; font-size: 2em; font-weight: bold; color: white; text-shadow: 2px 2px 0 #000; z-index: 10;">
                    高さ: <span id="contest-height">0</span>cm
                </div>
                <canvas id="contest-canvas" width="1160" height="640" style="background: #fffbe6; border: 4px solid var(--dark-brown); border-radius: 10px; cursor: none; margin-top: 0;"></canvas>
            </div>

            <!-- ★リズム・バーガータワー コンテスト画面 (6レーン構成・修正版) -->
            <div id="hungry-angry-game-screen" class="game-panel" style="display: none; padding: 0; width: 1000px; height: 700px; position: relative; overflow: hidden; background: #333;">
                <!-- 背景画像 -->
<div id="ha-bg-overlay" style="position: absolute; width: 100%; height: 200%; bottom: 0; background-image: url('images/contest-bg2.jpg'); background-size: 150% auto; background-position: bottom center; opacity: 0.6; transition: transform 0.1s linear;"></div>                <!-- リズムゲームキャンバス -->
                <canvas id="hungry-angry-canvas" width="1000" height="700" style="position: absolute; top: 0; left: 0; z-index: 5; pointer-events: none;"></canvas>

                <!-- UIヘッダー -->
                <div style="position: absolute; top: 20px; left: 0; width: 100%; height: 50px; z-index: 10;">
                    <!-- 高さ (左) 変更: スコア -> 高さ -->
                    <div style="position: absolute; left: 30px; color: white; font-size: 2em; font-weight: 800; font-family: inherit;">
                        高さ: <span id="ha-height">0</span>cm
                    </div>
                    <!-- コンボ (右) -->
                    <div style="position: absolute; right: 30px; color: white; font-size: 2em; font-weight: 800; font-family: inherit;">
                        コンボ: <span id="ha-combo">0</span>
                    </div>
                </div>

                <!-- 操作ボタンエリア (左右に広げる) -->
                <!-- 左サイド: left値を小さく -->
                <button class="ha-btn" id="btn-patty" style="left: 40px; bottom: 40px; border-color: #8d6e63;">
                    <img src="images/patty.png">
                </button>
                <button class="ha-btn" id="btn-egg" style="left: 170px; bottom: 40px; border-color: #f1c40f;">
                    <img src="images/egg.png">
                </button>
                <button class="ha-btn" id="btn-bacon" style="left: 300px; bottom: 40px; border-color: #e74c3c;">
                    <img src="images/bacon.png">
                </button>

                <!-- 右サイド: right値を小さく -->
                <button class="ha-btn" id="btn-lettuce" style="right: 40px; bottom: 40px; border-color: #2ecc71;">
                    <img src="images/lettuce.png">
                </button>
                <button class="ha-btn" id="btn-tomato" style="right: 170px; bottom: 40px; border-color: #e74c3c;">
                    <img src="images/tomato.png">
                </button>
                <button class="ha-btn" id="btn-cheese" style="right: 300px; bottom: 40px; border-color: #f39c12;">
                    <img src="images/cheese.png">
                </button>
                
                <!-- リアクションテキスト表示用 -->
                <div id="ha-judge-reaction" style="position: absolute; top: 150px; width: 100%; text-align: center; color: #fff; font-weight: 800; font-size: 3em; pointer-events: none; z-index: 20;"></div>

                <!-- スタートカウントダウン用オーバーレイ -->
                <div id="ha-overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; justify-content: center; align-items: center; z-index: 100; color: white; font-size: 5em; font-weight: 800; display: none;">
                    READY?
                </div>
            </div>

            <!-- 結果・名前入力画面 -->
            <div id="contest-result-screen" class="game-panel" style="display: none; width: 500px; text-align: center;">
                <h2>コンテスト終了！</h2>
                <div style="margin: 20px 0;">
                    <p style="font-size: 1.2em;">記録</p>
                    <p style="font-size: 3em; font-weight: 800; color: var(--main-orange); margin: 0;"><span id="contest-final-height">0</span>cm</p>
                </div>
                <p>名前を入れてね</p>
                <input type="text" id="contest-player-name" maxlength="8" style="font-size: 1.5em; padding: 10px; width: 80%; text-align: center; border-radius: 10px; border: 3px solid var(--dark-brown);" placeholder="名無しバーガー">
                <button id="contest-submit-button" class="action-button-style" style="background-color: var(--main-green); margin-top: 20px;">ランキング登録</button>
            </div>

            <!-- ランキング画面 -->
            <div id="contest-ranking-screen" class="game-panel" style="display: none; width: 500px; text-align: center;">
                <h2 style="color: var(--main-yellow); -webkit-text-stroke: 1px var(--dark-brown);">歴代ランキング</h2>
                <ul id="contest-ranking-list" style="list-style: none; padding: 0; text-align: left; margin: 20px 0; max-height: 300px; overflow-y: auto;"></ul>
                <button id="contest-ranking-close-button" class="action-button-style" style="background-color: var(--main-blue);">とじる</button>
            </div>
        </div>

        <div id="title-screen">
            <div class="title-container">
                <img class="title-logo" src="images/logo.png" alt="ゴールデンバーガー ロゴ">
                <button id="start-button">ゲームスタート！</button>
            </div>
        </div>

        <div id="game-wrapper">
            <div id="status-bar">
                おかね: <span id="money">0</span>円
            </div>
            
            <div id="main-area">
                <div id="customer-message">（お客さんを待っています...）</div>

                <div id="customer-area">
                    <div id="order-bubble"><h3>ご注文はこちら！</h3><ul id="order-list"></ul></div>
                </div>

                <div id="kitchen-display-area">
                    <img id="jukebox-object" src="images/jukebox.png" alt="ジュークボックス" style="display:none;">
                    <img id="customer-image" src="" alt="お客さん">
                    <img id="foreground-counter" src="images/counter.png" alt="カウンター">
                    <div id="creation-display">
                        <div id="burger-stack"></div>
                        <div id="drink-display-container"><div id="drink-display"><span>（のみもの）</span></div></div>
                    </div>
                    <div id="minigame-dock">
                        <div id="grill-minigame" class="minigame-container">
                            <h3>パティを焼こう！</h3>
                            <p>ベストなタイミングでストップ！</p>
                            <div id="grill-visuals">
                                <img id="grill-pan-image" src="images/frying-pan.png" alt="フライパン">
                                <img id="grill-item-image" src="" alt="焼いている食材">
                            </div>
                            <div class="grill-meter-bar">
                                <div class="grill-zone excellent"></div>
                                <div class="grill-zone good"></div>
                                <div class="grill-zone bad"></div>
                                <div id="grill-cursor" class="grill-cursor"></div>
                            </div>
                            <button id="grill-stop-button">ここでストップ！</button>
                        </div>
                        <div id="pour-minigame" class="minigame-container">
                            <h3>色のところでストップ！</h3>
                            <div class="pour-glass">
                                <div id="pour-liquid" class="pour-liquid"></div>
                                <div class="pour-zone excellent"></div>
                                <div class="pour-zone good"></div>
                            </div>
                            <button id="pour-button">ながおし</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="counter-area">
                <div class="counter-body">
                    <div id="action-buttons">
                        <button id="serve-button">できた！</button>
                        <button id="undo-button">ひとつ戻す</button>
                        <button id="trash-button">すてる</button>
                        <button id="show-restock-button">しいれ</button>
                    </div>
                    <div class="selection-panels">
                        <div id="ingredients-panel"></div>
                        <div id="drinks-panel"></div>
                    </div>
                </div>
            </div>

            <div id="completed-burger-modal" class="modal-overlay"></div>
        </div>
        
        <div id="restock-game-modal" class="modal-overlay">
            <div id="restock-selection-screen" class="restock-game-panel">
                <h2>食材を選んでください (最大3種類)</h2>
                <div id="restock-item-list"></div>
                <div id="restock-selection-footer">
                    <button id="restock-cancel-selection-button">やめる</button>
                    <div id="restock-summary">
                        <p>合計費用: <span id="restock-total-cost">0</span>円</p>
                    </div>
                    <button id="restock-confirm-selection-button" disabled>けってい</button>
                </div>
            </div>
        
            <div id="restock-confirm-popup" class="modal-overlay" style="display: none; background-color: rgba(0,0,0,0.7);">
                <div class="game-panel" style="width: 500px; text-align: center;">
                    <p id="restock-confirm-message" style="font-size: 1.3em; margin-bottom: 30px;">合計 〇〇円を支払って<br>仕入れゲームを始めますか？</p>
                    <div style="display: flex; justify-content: center; gap: 20px;">
                        <button id="restock-pay-button" class="action-button-style">支払う</button>
                        <button id="restock-cancel-button" class="action-button-style">やめる</button>
                    </div>
                </div>
            </div>
        
            <div id="restock-minigame-screen" class="restock-game-panel" style="display: none;">
                <div id="minigame-hud">
                    <div id="minigame-timer">30</div>
                    <div id="minigame-realtime-score"></div>
                    <button id="restock-abort-button">ちゅうだん</button>
                </div>
                <canvas id="catch-game-canvas" width="800" height="500"></canvas>
            </div>
        
            <div id="restock-result-screen" class="restock-game-panel" style="display: none;">
                <h2>ゲットした食材：お店には10こまでしかおけないよ</h2>
                <div id="restock-result-list"></div>
                <div style="display: flex; justify-content: center; gap: 20px; margin-top: 20px;">
                    <button id="restock-again-button">もう一度仕入れ</button>
                    <button id="restock-return-to-game-button">お店に戻る</button>
                </div>
            </div>
        </div>

        <div id="day-start-overlay" class="modal-overlay" style="display:none; background-color: rgba(0,0,0,1); z-index: 6000;">
            <div id="day-start-text">1日目 スタート</div>
        </div>

        <div id="daily-result-modal" class="modal-overlay" style="z-index: 5500;">
            <div class="game-panel" style="width: 600px; text-align: center;">
                <h2>今日の営業終了！</h2>
                <div class="daily-result-content">
                    <div class="result-row"><span>売上:</span> <span id="result-revenue">0</span>円</div>
                    <div class="result-row"><span>けいひ:</span> <span id="result-expenses">0</span>円</div>
                    <hr style="border: 2px dashed var(--dark-brown); margin: 10px 0;">
                    <div class="result-row large"><span>収支:</span> <span id="result-profit">0</span>円</div>
                    <div class="result-row"><span>お客さん:</span> <span id="result-customers">0</span>人</div>
                    <div class="result-row"><span>合計得点:</span> <span id="result-score">0</span>点</div>
                </div>
                <button id="next-day-button" class="action-button-style" style="margin-top: 20px; background-color: var(--main-blue);">次の日へ</button>
            </div>
        </div>

        <div id="rank-up-modal" class="modal-overlay" style="z-index: 7000;">
            <div class="game-panel rank-up-content">
                <h2>祝！ランクアップ！</h2>
                <div id="rank-up-message">
                    お店のひょうかが<br>星<span id="rank-up-star-count">1</span>に、にんていされました！<br>おめでとうございます！
                </div>
                <img src="images/logo.png" alt="ロゴ" class="rank-up-logo">
                <div id="rank-up-stars-display"></div>
                <button id="close-rank-up-button" class="action-button-style">やったー！</button>
            </div>
        </div>

        <!-- ランク情報確認モーダル -->
        <div id="rank-info-modal" class="modal-overlay" style="z-index: 6500;">
            <div class="game-panel rank-up-content">
                <h2 style="font-size: 2.5em; color: var(--dark-brown);">現在のお店ランク</h2>
                
                <!-- ロゴ画像 -->
                <img src="images/logo.png" alt="ロゴ" class="rank-up-logo" style="width: 200px; margin: 10px 0;">

                <!-- 現在の星 -->
                <div id="rank-info-stars" style="display: flex; justify-content: center; gap: 10px; margin: 20px 0;">
                    <!-- JSで生成 -->
                </div>

                <div style="font-size: 1.5em; font-weight: bold; margin: 20px 0; color: var(--dark-brown);">
                    <p style="margin: 5px;">次のランクまで</p>
                    <p style="font-size: 1.8em; color: var(--main-orange);">
                        <span id="rank-current-score">0</span> / <span id="rank-next-target">0</span>
                    </p>
                </div>

                <button id="close-rank-info-button" class="action-button-style" style="background-color: var(--main-blue);">閉じる</button>
            </div>
        </div>

    </div>

    <script src="data.js"></script>
    <script src="game-core.js"></script>
    <script src="game-sound.js"></script>
    <script src="game-ui.js"></script>
    <script src="game-logic.js"></script>
    <script src="game-minigames.js"></script>
    <script src="game-contest.js"></script>
    <script src="game-contest2.js"></script>
    <script src="main.js"></script>
</body>
</html>